# Place all the behaviors and hooks related to the matching controller here.
# All this logic will automatically be available in application.js.
# You can use CoffeeScript in this file: http://coffeescript.org/

$(document).ready ->
 
  $(window).unload ->
  
  $(window).load ->
    $("#home").fadeIn 1500
    $("#about").fadeIn 1500

  $('body').css('display', 'none');
  $('body').fadeIn(1500);

  $("#left-panel").height (index, height) ->
    window.innerHeight - $(this).offset().top

  $("#right-panel").height (index, height) ->
    window.innerHeight - $(this).offset().top

  $("#encase").height (index, height) ->
    window.innerHeight - $(this).offset().top 
# 
#* Function to animate leaving a page
#

$.fn.leavePage = ->
  @click (event) ->
    
    # Don't go to the next page yet.
    event.preventDefault()
    linkLocation = @href
    
    # Fade out this page first.
    $("body").fadeOut 500, ->
      
      # Then go to the next page.
      window.location = linkLocation


# 
#* Call the leavePage function upon link clicks with the "transition" class
#
$(".transition").leavePage()
$(".arrows_about_up").leavePage()

# Gallery
if jQuery("#gallery").length
    
    # Declare variables
    totalImages = jQuery("#gallery > li").length
    imageWidth = jQuery("#gallery > li:first").outerWidth(true)
    totalWidth = imageWidth * totalImages
    visibleImages = Math.round(jQuery("#gallery-wrap").width() / imageWidth)
    visibleWidth = visibleImages * imageWidth
    stopPosition = (visibleWidth - totalWidth)
    jQuery("#gallery").width totalWidth
    jQuery("#gallery-prev").click ->
      jQuery("#gallery").animate left: "+=" + imageWidth + "px"  if jQuery("#gallery").position().left < 0 and not jQuery("#gallery").is(":animated")
      false

    jQuery("#gallery-next").click ->
      jQuery("#gallery").animate left: "-=" + imageWidth + "px"  if jQuery("#gallery").position().left > stopPosition and not jQuery("#gallery").is(":animated")
      false


